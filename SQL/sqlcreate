-- users table --

DROP TABLE IF EXISTS `rentmyhouse`.`users` ;

CREATE TABLE IF NOT EXISTS `rentmyhouse`.`users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(20) BINARY NOT NULL UNIQUE,
  `password` VARCHAR(150) BINARY NOT NULL,
  `salt` VARCHAR(8) BINARY NOT NULL,
  `email` VARCHAR(45) BINARY NOT NULL UNIQUE,
  `verificationCode` VARCHAR(5) NOT NULL,
  `active` TINYINT(1) NULL DEFAULT 0,
  PRIMARY KEY (`id`))
  ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1;



-- houses table --

DROP TABLE IF EXISTS `rentmyhouse`.`houses` ;

CREATE TABLE IF not exists `rentmyhouse`.`houses` (
`houseID` INT NOT NULL AUTO_INCREMENT ,
`name` VARCHAR(50) NOT NULL ,
`state` VARCHAR(200) NOT NULL ,
`address` VARCHAR(200) NOT NULL ,
`price` DOUBLE NOT NULL ,
`meter` DOUBLE NOT NULL ,
`telephone` TINYINT NOT NULL ,
`wifi` TINYINT NULL DEFAULT NULL ,
`pool` TINYINT NULL DEFAULT NULL ,
`maid` TINYINT NULL DEFAULT NULL ,
`description` TEXT NOT NULL ,
`stars` SMALLINT NOT NULL ,
`longitude` DOUBLE NOT NULL ,
`latitude` DOUBLE NOT NULL,
`imageName` VARCHAR(100) NOT NULL,
'userID' int(11)  NOT NULL,
PRIMARY KEY (`houseID`, userID),
  INDEX `fk_house_users1_idx` (userID ASC),
  CONSTRAINT `fk_house_users1`
    FOREIGN KEY (userID)
    REFERENCES `rentmyhouse`.`users` (`username`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- image table --

DROP TABLE IF EXISTS `rentmyhouse`.`houses` ;

CREATE TABLE IF NOT EXISTS `rentmyhouse`.`images` (
  `imageID` INT NOT NULL AUTO_INCREMENT,
  `imageName` VARCHAR(100) NULL,
  `imageDescr` MEDIUMTEXT NULL,
  `houses_houseID` INT NOT NULL,
  `houses_userID` int(11) NOT NULL,
  PRIMARY KEY (`imageID`, `houses_houseID`, `houses_userID`),
  INDEX `fk_photos_villas1_idx` (`houses_houseID` ASC, `houses_userID` ASC),
  CONSTRAINT `fk_photos_villas1`
  FOREIGN KEY (`houses_houseID` , `houses_userUsername`)
  REFERENCES rentmyhouse.`houses` (`houseID` , userID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;